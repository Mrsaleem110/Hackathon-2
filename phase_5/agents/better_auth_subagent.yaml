name: "better_auth_subagent"
version: "1.0.0"
description: "Better Auth Manager - Handles authentication and authorization using Better Auth"
author: "Claude"
license: "MIT"
main_module: "agents.better_auth_subagent"
entry_point: "BetterAuthSubagent"
capabilities:
  - "create-user"
  - "authenticate-user"
  - "manage-sessions"
  - "create-organization"
  - "manage-organization-members"
  - "enable-two-factor"
  - "rate-limiting"
  - "user-management"
dependencies:
  - "skills.better_auth"
configuration:
  default_rate_limit: 10
  default_rate_window: 60
  enable_logging: true
tasks:
  - name: "create_user"
    description: "Create a new user with email and password authentication"
    parameters:
      - name: "email"
        type: "string"
        required: true
        description: "User's email address"
      - name: "password"
        type: "string"
        required: true
        description: "User's password"
      - name: "name"
        type: "string"
        required: false
        description: "User's name"
      - name: "metadata"
        type: "object"
        required: false
        description: "Additional user metadata"

  - name: "authenticate_user"
    description: "Authenticate a user with email and password"
    parameters:
      - name: "email"
        type: "string"
        required: true
        description: "User's email address"
      - name: "password"
        type: "string"
        required: true
        description: "User's password"

  - name: "create_session"
    description: "Create a new session for a user"
    parameters:
      - name: "user_id"
        type: "string"
        required: true
        description: "ID of the user to create session for"

  - name: "verify_session"
    description: "Verify if a session is valid"
    parameters:
      - name: "session_id"
        type: "string"
        required: true
        description: "ID of the session to verify"

  - name: "create_organization"
    description: "Create a new organization"
    parameters:
      - name: "name"
        type: "string"
        required: true
        description: "Name of the organization"
      - name: "owner_user_id"
        type: "string"
        required: true
        description: "ID of the user who will be the owner"
      - name: "metadata"
        type: "object"
        required: false
        description: "Additional organization metadata"

  - name: "add_user_to_organization"
    description: "Add a user to an organization"
    parameters:
      - name: "org_id"
        type: "string"
        required: true
        description: "ID of the organization"
      - name: "user_id"
        type: "string"
        required: true
        description: "ID of the user to add"
      - name: "role"
        type: "string"
        required: false
        default: "member"
        description: "Role to assign to the user"

  - name: "enable_two_factor"
    description: "Enable two-factor authentication for a user"
    parameters:
      - name: "user_id"
        type: "string"
        required: true
        description: "ID of the user"
      - name: "method"
        type: "string"
        required: false
        default: "totp"
        description: "2FA method to use"

  - name: "rate_limit_check"
    description: "Check if a rate limit has been exceeded"
    parameters:
      - name: "identifier"
        type: "string"
        required: true
        description: "Identifier for the rate limit (e.g., IP address, user ID)"
      - name: "limit"
        type: "integer"
        required: false
        default: 10
        description: "Number of requests allowed"
      - name: "window"
        type: "integer"
        required: false
        default: 60
        description: "Time window in seconds"

  - name: "get_user_info"
    description: "Get information about a specific user"
    parameters:
      - name: "user_id"
        type: "string"
        required: true
        description: "ID of the user to get information for"

  - name: "list_users"
    description: "List all registered users"
    parameters: []

  - name: "list_sessions"
    description: "List all active sessions"
    parameters: []

  - name: "list_organizations"
    description: "List all registered organizations"
    parameters: []

intents:
  - pattern: "create user with email (.*) and password (.*)"
    task: "create_user"
    parameters:
      email: "$1"
      password: "$2"

  - pattern: "authenticate user with email (.*) and password (.*)"
    task: "authenticate_user"
    parameters:
      email: "$1"
      password: "$2"

  - pattern: "create organization named (.*) owned by (.*)"
    task: "create_organization"
    parameters:
      name: "$1"
      owner_user_id: "$2"

  - pattern: "add user (.*) to organization (.*) with role (.*)"
    task: "add_user_to_organization"
    parameters:
      user_id: "$1"
      org_id: "$2"
      role: "$3"

  - pattern: "enable two factor for user (.*) using (.*)"
    task: "enable_two_factor"
    parameters:
      user_id: "$1"
      method: "$2"

  - pattern: "check rate limit for (.*)"
    task: "rate_limit_check"
    parameters:
      identifier: "$1"

  - pattern: "list all users"
    task: "list_users"

  - pattern: "list all organizations"
    task: "list_organizations"

  - pattern: "get info for user (.*)"
    task: "get_user_info"
    parameters:
      user_id: "$1"

examples:
  - input: "Create user with email john@example.com and password secure123"
    output: "Creates a new user account with the specified email and password"

  - input: "Authenticate user with email john@example.com and password secure123"
    output: "Verifies the user's credentials and creates a session if valid"

  - input: "Create organization named Acme Corp owned by user-123"
    output: "Creates a new organization with the specified owner"

  - input: "Enable two factor for user user-123 using totp"
    output: "Enables TOTP-based two-factor authentication for the user"

  - input: "List all users"
    output: "Returns a list of all registered users"